<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Eat Simulation</title>
<style>
  html, body { margin:0; padding:0; overflow:hidden; background:black; height:100%; }
  #bg {
    position:absolute; width:100%; height:100%;
    background:url('https://i.imgur.com/fv321cH.jpeg') center/cover no-repeat;
    filter: contrast(1.2) brightness(0.9); transition: filter .2s;
  }
  .glitch { animation: glitch .6s infinite; }
  @keyframes glitch {
    0% { filter: hue-rotate(0deg) contrast(1.3) brightness(1.1); }
    50% { filter: hue-rotate(45deg) contrast(1.8) brightness(1.3); }
    100% { filter: hue-rotate(-20deg) contrast(1.3) brightness(1.1); }
  }
  .imgPiece {
    position:absolute; width:150px; height:150px; object-fit:cover;
    mix-blend-mode:screen; opacity:0.8; transition: transform 2s ease-out, opacity 2s;
  }

  /* back 버튼 (트리거) */
  #backBtn {
    position:absolute; top:20px; left:20px; z-index:101;
    color:white; font-size:14px;
    background:rgba(255,255,255,0.1); border:1px solid white;
    border-radius:5px; padding:6px 12px; cursor:pointer;
  }

  /* eat 버튼 */
  #eatBtn {
    position:absolute; bottom:30px; left:50%; transform:translateX(-50%);
    font-family:'Courier New', monospace; font-size:14px; color:white;
    background:rgba(255,255,255,0.1); border:1px solid white;
    border-radius:5px; padding:8px 14px; cursor:pointer;
    transition:background .2s;
  }
  #eatBtn:hover { background:rgba(255,255,255,0.3); }

  #message {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    color:white; font-family:monospace; font-size:18px; opacity:0; transition:opacity 1s;
  }
  .noise { position:absolute; width:4px; height:4px; background:black; border-radius:50%; opacity:0.8; pointer-events:none; }

  #clickHint {
    position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
    color:white; font-family:monospace; font-size:14px; opacity:0; animation:fadeInOut 4s forwards; z-index:10;
  }
  @keyframes fadeInOut { 0%{opacity:0} 10%{opacity:1} 80%{opacity:1} 100%{opacity:0} }
</style>
</head>
<body>
  <div id="bg"></div>

  <!-- back 버튼: 누르면 header.html에서 href 읽어서 즉시 이동 -->
  <button id="backBtn">← back</button>

  <button id="eatBtn">eat!</button>
  <div id="clickHint">click anywhere...</div>
  <div id="message">Goodbye. Go to the bathroom.</div>

<script>
  // --- back 버튼: header.html 불러와서 내부 <a> href로 즉시 이동 ---
  document.getElementById('backBtn').addEventListener('click', () => {
    fetch('header.html', { cache: "no-store" }) // 캐시 방지로 항상 최신 header.html을 가져옴
      .then(res => {
        if (!res.ok) throw new Error('header.html 로드 실패: ' + res.status);
        return res.text();
      })
      .then(htmlText => {
        // 문자열을 DOM으로 파싱해서 a[href] 찾기
        const parser = new DOMParser();
        const doc = parser.parseFromString(htmlText, 'text/html');
        const a = doc.querySelector('a[href]');
        if (a && a.getAttribute('href')) {
          const href = a.getAttribute('href');
          // 바로 이동 (절대/상대 모두 동작)
          window.location.href = href;
        } else {
          // 실패 시 알림 (개발용)
          console.error('header.html에 a[href]가 없습니다.');
          alert('링크를 찾을 수 없습니다 (header.html에 a[href]가 있어야 합니다).');
        }
      })
      .catch(err => {
        console.error('header fetch 에러:', err);
        alert('header.html 불러오기에 실패했습니다.');
      });
  });

  // --- 기존 eat 기능 (원래대로 유지) ---
  const images = [
    'https://i.imgur.com/yV65FcW.jpeg','https://i.imgur.com/w5ExU4W.jpeg','https://i.imgur.com/xXJ8vk9.jpeg',
    'https://i.imgur.com/EW42bbG.jpeg','https://i.imgur.com/3wQUuh2.jpeg','https://i.imgur.com/EW42bbG.jpeg','https://i.imgur.com/aMfgYEA.jpeg'
  ];

  document.body.addEventListener('click', e => {
    // backBtn과 eatBtn 클릭은 이미지 생성 제외
    if (e.target.id === 'eatBtn' || e.target.id === 'backBtn') return;

    const img = document.createElement('img');
    img.src = images[Math.floor(Math.random()*images.length)];
    img.className = 'imgPiece';
    img.style.left = (e.clientX - 75) + 'px';
    img.style.top = (e.clientY - 75) + 'px';
    img.style.transform = `rotate(${Math.random()*20-10}deg) scale(${0.8+Math.random()*0.5})`;
    document.body.appendChild(img);
  });

  // eat 버튼 이펙트 (네가 원래 쓰던 것 유지)
  document.getElementById('eatBtn').addEventListener('click', () => {
    document.body.classList.add('glitch');

    document.querySelectorAll('.imgPiece').forEach(piece => {
      piece.style.transform = `translate(${(Math.random()-0.5)*500}px, ${(Math.random()-0.5)*500}px) rotate(${Math.random()*720-360}deg) scale(0.3)`;
      piece.style.opacity = 0;
    }); 

    for (let i = 0; i < 200; i++) {
      const dot = document.createElement('div');
      dot.className = 'noise';
      dot.style.left = `${Math.random()*window.innerWidth}px`;
      dot.style.top = `${Math.random()*window.innerHeight}px`;
      document.body.appendChild(dot);
      setTimeout(() => dot.remove(), 3000 + Math.random()*2000);
    }

    const bug = document.createElement('div');
    bug.style.position = 'absolute';
    bug.style.width = '40px';
    bug.style.height = '20px';
    bug.style.background = 'black';
    bug.style.borderRadius = '50%';
    bug.style.left = '-50px';
    bug.style.top = `${Math.random()*window.innerHeight}px`;
    bug.style.transition = 'left 3s linear';
    document.body.appendChild(bug);
    setTimeout(() => bug.style.left = `${window.innerWidth + 50}px`, 50);
    setTimeout(() => bug.remove(), 4000);

    setTimeout(() => { document.getElementById('message').style.opacity = 1; }, 4000);
    setTimeout(() => { document.body.classList.remove('glitch'); }, 5000);
  });
</script>
</body>
</html>


